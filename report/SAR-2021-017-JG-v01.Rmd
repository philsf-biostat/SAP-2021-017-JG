---
title: "[title]"
subtitle: 'DOCUMENTO: SAR-2021-017-JG-v01'
author: '**De:** Felipe Figueiredo **Para:** Josir Gomes'
# date: yyyy-mm-dd
output:
  html_document:
    fig_caption: yes
    fig_height: 6
    fig_width: 6
    keep_md: yes
    number_sections: yes
    toc: yes
  pdf_document:
    number_sections: yes
    toc: yes
  word_document:
    fig_caption: yes
    fig_height: 6
    fig_width: 6
    reference_docx: misc/style_SAR_pt.docx
    toc: yes
toc-title: "Sumário"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_knit$set(root.dir = normalizePath(".."))
options(scipen = 999)
library(pander)
library(knitr)
library(philsfmisc)
panderOptions('table.style', 'rmarkdown')
panderOptions('table.split.table', 160)
```

---

**[title]**

**Histórico do documento**

```{r history}
Version <- c("01")
Changes <- c("Versão inicial")
history <- cbind(Version, Changes)
colnames(history) <- c("Versão", "Alterações")
# pander(history, split.cells = 70)
kable(history)
```

---

# Lista de abreviaturas

# Contexto

## Objetivos

## Recepção e tratamento dos dados

# Metodologia

```{r results, include=FALSE}
source("scripts/results.R", encoding = 'UTF-8')
n.hp <- length(ks)*length(dists)*length(meths)
```

## Variáveis

### Desfechos primário e secundário

### Covariáveis

## Análises Estatísticas

Esta análise foi realizada utilizando-se o software `R` versão `r getRversion()`.

# Resultados

## Espaço de hiperparâmetros

Ao todo foram incluídas `r n.hp` combinações dos três hiperparâmetros, com suas respectivas clusterizações hierárquicas geradas e silhuetas médias calculadas.
Como a visualização de um espaço com quatro dimensões é desafiadora, vamos inicialmente considerar as projeções em espaços bidimensionais e avaliar a variabilidade de performance mensurado pelas silhuetas médias em cada hiperparâmetro.

Trocando as métricas de distância (Figura 1) a melhor performance foi obtida pela métrica maximum, com silhueta média 0.461, seguida da métrica de Minkowski com p = 0.5 (silhueta média 0.424).
As métricas de Minkowski com p = 1.5 e Canberra tiveram a pior performance geral com as maiores silhuetas médias atingindo 0.383 e 0.335, respectivamente.
As menores silhuetas médias foram observadas na métrica de Minkowski com p = 0.5 e Manhanttan (silhueta média -0.0857 e 0.00716, respectivamente).

```{r fig1, fig.cap="**Figura 1** Distribuição da idade na população do estudo."}
# ![Age](../figures/distr_age.png)
knitr::include_graphics("../figures/bp_d.png", error = FALSE)
```

Trocando os métodos de ligação o maior valor de silhueta foi observado simultaneamente em três métodos: centroide, mediana e single com silhueta média 0.461.
O segundo maior valor observado foi outro empate, desta vez entre os métodos ward.D e ward.D2 (0.424).
Os dois menores valores de silhueta foram observados com o método single (-0.0857) e mediana (-0.0628).

```{r fig2, fig.cap="**Figura 2** Distribuição da idade na população do estudo."}
# ![Age](../figures/distr_age.png)
knitr::include_graphics("../figures/bp_m.png", error = FALSE)
```

```{r fig3, fig.cap="**Figura 3** Distribuição da idade na população do estudo."}
# ![Age](../figures/distr_age.png)
knitr::include_graphics("../figures/bp_k.png", error = FALSE)
```


```{r tab1}
final_top %>%
  kable(
    row.names = TRUE,
    col.names = c(
      k = attr(final_top$k, "label"),
      dist = attr(final_top$dist, "label"),
      meth = attr(final_top$meth, "label"),
      sil = attr(final_top$sil, "label")
      ),
    digits = 4,
    caption = "**Tabela 1** Combinações de hiperparâmetros com os dez maiores valores de silhueta média.  
    euclidian = Métrica Euclidiana (norma 2);
    centroid = Método de ligação centróide;
    maximum = Métrica do supremo (norma infinito);
    median = Método de ligação da mediana;
    minkowski_0.5 = Métrica de Minkowski (norma p), p = 0.5;
    single = Método de ligação single (distância mínima);
    ward.D = Método de ligação de Ward (sem critério de Ward 1963);
    ward.D2 = Método de ligação de Ward (com critério de Ward 1963)."
  )
```

```{r fig4, fig.cap="**Figura 4** Silhuetas médias das combinações de hiperparâmetros avaliadas. Linhas tracejadas indicam os dez maiores valores de silhueta média observados."}
# average = Método de ligação média (distância média);
# canberra = Métrica de Canberra;
# centroid = Método de ligação centróide;
# complete = Método de ligação completa (distância máxima);
# euclidian = Métrica Euclidiana (norma 2);
# manhattan = Métrica de Manhattan (norma 1);
# maximum = Métrica do supremo (norma infinito);
# median = Método de ligação da mediana;
# minkowski_0.5 = Métrica de Minkowski (norma p), p = 0.5;
# minkowski_1.5 = Métrica de Minkowski (norma p), p = 1.5;
# single = Método de ligação single (distância mínima);
# ward.D = Método de ligação de Ward (sem critério de Ward 1963);
# ward.D2 = Método de ligação de Ward (com critério de Ward 1963).
# ![Age](../figures/hiper.png)
knitr::include_graphics("../figures/hiper.png", error = FALSE)
```

## Silhuetas das soluções ótimas

```{r fig5, fig.cap="**Figura 5** caption."}
# ![Age](../figures/sil_final.png)
knitr::include_graphics("../figures/sil_final.png", error = FALSE)
```

```{r fig6, fig.cap="**Figura 6** caption."}
# ![Age](../figures/sil_rej.png)
knitr::include_graphics("../figures/sil_rej.png", error = FALSE)
```

# Observações e limitações

# Conclusões

# Referências

- **SAP-2021-017-JG-v01** -- Plano Analítico para [title]

# Apêndice

## Análise exploratória de dados

```{r A1, fig.cap="**Figura A1** Distribuição da idade na população do estudo."}
# ![Age](../figures/distr_age.png)
# knitr::include_graphics("../figures/distr_age.png", error = FALSE)
```

## Disponibilidade

Tanto este documento como o plano analítico correspondente (**SAP-2021-017-JG-v01**) podem ser obtidos no seguinte endereço:

<!-- Este documento pode ser obtido no seguinte endereço: -->

<https://philsf-biostat.github.io/SAR-2021-017-JG/>

## Dados utilizados

Os dados utilizados neste relatório não podem ser publicados online por questões de sigilo.

```{r data}
# print analytical of analytical_mockup whether it is the private or public version of the SAR

# analytical %>%
#   pander(caption = "**Tabela A1** Tabela de dados analíticos")
analytical_mockup %>%
  pander(caption = "**Tabela A1** Estrutura da tabela de dados analíticos")
```
